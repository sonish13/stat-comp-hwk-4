---
title: "stat-comp-hwk-4"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Question 1b
```{r}
options(
  ggplot2.continuous.colour = "viridis",
  ggplot2.continuous.fill = "viridis",
  ggplot2.discrete.colour = "brewer",
  ggplot2.discrete.fill = "brewer")
library(patchwork)
library(tidyverse)
x <- seq(0,2*pi,length.out = 500)
y <- seq(0,2*pi,length.out = 500)
f <- function(x,y){
 1/2*(sin(2*x) + sin(2*y))
}
df <- expand.grid(x=x, y=y)
value <- vector()
for (i in seq_along(df$x)) {
 value[i] = f(df$x[i],df$y[i])  
}
df$value <- value
p1 = ggplot(df, aes(x,y))+
      geom_raster(aes(fill= value),interpolate = TRUE) +
      scale_fill_continuous(name = "f(x,y)") +
      theme_minimal() +
      scale_x_continuous(breaks = c(0, pi/2, pi, 3*pi/2, 2*pi),
      label = c(0, expr(pi / 2), expression(pi), expr(3 * pi / 2), expr(2 * pi)),
      minor_breaks = NULL) +
      scale_y_continuous(breaks = c(0, pi/2, pi, 3*pi/2, 2*pi),
      label = c(0, expr(pi / 2), expression(pi), expr(3 * pi / 2), expr(2 * pi)),
      minor_breaks = NULL) +
      coord_equal()
     
p2 = ggplot(df,aes(x,y,z = value)) +
      geom_contour(aes(colour = after_stat(nlevel))) +
      theme_minimal() +
      scale_x_continuous(breaks = c(0, pi/2, pi, 3*pi/2, 2*pi),
      label = c(0, expr(pi / 2), expression(pi), expr(3 * pi / 2), expr(2 * pi)),
      minor_breaks = NULL) +
      scale_y_continuous(breaks = c(0, pi/2, pi, 3*pi/2, 2*pi),
      label = c(0, expr(pi / 2), expression(pi), expr(3 * pi / 2), expr(2 * pi)),
      minor_breaks = NULL) +
      scale_colour_continuous(name = "f(x,y)") +
      coord_equal()
p1 + p2
```

## Question 1c
```{r}
df <- data.frame(x = 1:5, y = 1:5)
dens_df<- data.frame(expand.grid(x = MASS::kde2d(df$x,df$y)$x,y = MASS::kde2d(df$x,df$y)$y),
                     density = as.vector(MASS::kde2d(df$x,df$y)$z)
                      )
ggplot() +
  geom_raster(data=dens_df,aes(x,y, fill=density), interpolate = TRUE) +
  geom_point(data=df,aes(x,y), color = "red", size = 4) +
  theme_minimal() +
  scale_x_continuous(limits = c(0, 6), minor_breaks = NULL) +
  scale_y_continuous(limits = c(0, 6), minor_breaks = NULL) +
  coord_equal()
?MASS::kde2d
```

## Question 2b

```{r}

```

